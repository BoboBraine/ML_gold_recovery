 # ML модель для прогноза восстановления золота из руды
 
 # Описаеие проекта
Нужно подготовьте прототип модели машинного обучения для Компании. Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Предоставлены данные с параметрами добычи и очистки.

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

 # Использованные данные
 **Описание данных**

**Технологический процесс**

- Rougher feed — исходное сырье

- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant

- Xanthate — ксантогенат (промотер, или активатор флотации);

- Sulphate — сульфат (на данном производстве сульфид натрия);

- Depressant — депрессант (силикат натрия).

- Rougher process (англ. «грубый процесс») — флотация

- Rougher tails — отвальные хвосты

- Float banks — флотационная установка

- Cleaner process — очистка

- Rougher Au — черновой концентрат золота

- Final Au — финальный концентрат золота

**Параметры этапов**

- air amount — объём воздуха

- fluid levels — уровень жидкости

- feed size — размер гранул сырья

- feed rate — скорость подачи

**Наименование признаков**

Наименование признаков должно быть такое:

*[этап].[тип_параметра].[название_параметра]*

Пример: *rougher.input.feed_ag*

Возможные значения для блока [этап]:

- rougher — флотация

- primary_cleaner — первичная очистка

- secondary_cleaner — вторичная очистка

- final — финальные характеристики

Возможные значения для блока [тип_параметра]:

- input — параметры сырья

- output — параметры продукта

- state — параметры, характеризующие текущее состояние этапа

- calculation — расчётные характеристики

*Сами данные уже разделены на тестовую и обучающую выборки.*

# План работы

1) Проверить верно ли расчитано значение восстановления золота из руды

2) Просмотреть на разницу признаков в обучающей и тестовой выборках

3) Предобработать данные

4) Проанализировать изменения концентраций металлов на различных этапах

5) Сравним распределение размеров гранул исходного сырья на выборках

6) Исследовать суммарную концентрацию металлов на разных стадиях

7) Найти лучшие модели по оценке sMAPE для этапа флотации и очистки

8) Проверить модели на адекватность

 # Результаты
 
 - После пересчета и анализа данных, было выявлено, что значения recovery в сырых данных расчитано корректно.
 `MAE` между исходными данными и данными расчитанными в незначительно отклоняется от 0.
 
 - Из обучающего датасета были убраны признаки, своевременный мониториг которых недостаточно оперативен
 
 - Анализ концентраций золота на каждом этапе подтвержает отсутствие явных анамалий в процессе обогащения. После каждого этапа концентрации золота растут.
 
 ![Гистограммы концентраций золота на каждом эжтапе](attachment:%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%BE-2.png)
 
 - ССЫЛКА НА ГРАФИК ПЛОТНОСТИ
 Сравнительного анализ распределений обучающей и тестовой выборок показал, что будет корректно сопоставлять данные между выборками. Визуальный анализ подтвердил их схожесть. T-тест о равенстве средних подтвердил нулевую гипотеу о равенстве среднийх значений по выборкам. `pvalue = 0.923`
 
 
 
 - ССЫЛКА НА ГИСТОГРАММЫ СУММАРНЫХ КОНЦЕНТРАЦИЙ
 
 
 
 
 
|             |   sMAPE_rougher |   sMAPE_cleaner |   final_sMAPE |
|:------------|----------------:|----------------:|--------------:|
| model       |         3.09739 |         6.59578 |       5.90847 |
| dummy_train |         6.93062 |         9.79593 |       9.0796  |
| dummy_test  |         5.8968  |         9.13331 |       8.32418 |
 
 - Лучшими моделями показали себя RandomForestRegressor с наилучшими показателями для флотации на тестовой выборке *SMAPE* в `3.09739` , для очистки и `6.59578`  *final sMAPE* `5.90847`.
 
 - Все модели прошли проверку на адекватность.
 - 
